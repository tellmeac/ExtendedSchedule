@startuml class_diagramm

namespace domain {
    namespace entity {
        class Lesson <Entity> {

        }

        class ExcludedLesson <Entity> {
            +ID uuid.UUID
            +LessonRef LessonRef
        }

        class ExtendedLesson <Entity> {
            +ID uuid.UUID
            +Author uuid.UUID
            +IsPrivate bool
            +Context *LessonContext
            +Intervals []LessonInterval
        }

        class GroupInfo <Entity> {
            + ID uuid.UUID
            + Name string
        }
    }

    namespace aggregate {
        class UserConfig <Aggregate> {
            +UserID uuid.UUID
            +JoinedGroups []GroupInfo
            +IgnoredLessons []ExcludedLesson
            +ExtendedLessons []ExtendedLesson
        }

        class DaySchedule <Aggregate> {
            +Date time.Time
            +Sections []Section
        }

        class Section <Aggregate> {
            +Position int
            +Lessons []Lesson
        }

        DaySchedule "M" o-- Section
        Section "M" o-- "1" domain.entity.Lesson
    }

    domain.aggregate.UserConfig "M" o-- "1" domain.entity.ExcludedLesson
    domain.aggregate.UserConfig "M" o-- "1" domain.entity.ExtendedLesson
    domain.aggregate.UserConfig "M" o-- "1" domain.entity.GroupInfo

    namespace repository {
        interface IExcludedRepository {
            +Get(userID uuid.UUID) []ExcludedLesson
            +Update(userID uuid.UUID, desired []ExcludedLesson) []ExcludedLesson
        }

        interface IExtendedRepository {
            +Get(userID uuid.UUID) []ExtendedLesson
            +Update(userID uuid.UUID, desired []entity.ExtendedLesson) []ExtendedLesson
        }

        interface IGroupRepository {
            +Get(userID uuid.UUID) []GroupInfo
            +Update(userID uuid.UUID, desired []GroupInfo) []GroupInfo
        }
    }

    namespace providers {
        interface IBaseScheduleProvider {
            +GetByGroupID(groupID string) []DaySchedule
        }

        IBaseScheduleProvider --> domain.entity.DaySchedule
    }

    namespace factory {
        interface IUserConfigFactory {
            +Make(userID uuid.UUID) aggregate.UserConfig
        }

        IUserConfigFactory --> domain.aggregate.UserConfig

        class userConfigFactory implements IUserConfigFactory {
            -schedule IBaseScheduleProvider
            -excluded IExcludedRepository
            -extended IExtendedRepository
            -userConfig IUserConfigRepository
        }

        userConfigFactory "1" o-- "1" domain.repository.IExcludedRepository
        userConfigFactory "1" o-- "1" domain.repository.IExtendedRepository
        userConfigFactory "1" o-- "1" domain.repository.IGroupRepository
        userConfigFactory "1" o-- "1" domain.providers.IBaseScheduleProvider

        interface IUserScheduleFactory {
            +Make(userID uuid.UUID) aggregate.UserConfig
        }

        IUserScheduleFactory --> domain.aggregate.UserConfig

        class userscheduleFactory implements IUserScheduleFactory {
            -schedule IBaseScheduleProvider
            -excluded IExcludedRepository
            -extended IExtendedRepository
            -userConfig IUserConfigRepository
        }

        userscheduleFactory "1" o-- "1" domain.repository.IExcludedRepository
        userscheduleFactory "1" o-- "1" domain.repository.IExtendedRepository
        userscheduleFactory "1" o-- "1" domain.repository.IGroupRepository
        userscheduleFactory "1" o-- "1" domain.providers.IBaseScheduleProvider
    }
}

namespace service {
    namespace userconfig {
        interface IService {

        }

        class service implements IService {
            -userConfigFactory IUserConfigFactory
            -excluded IExcludedRepository
            -extended IExtendedRepository
            -userConfig IUserConfigRepository
        }

        service "1" o-- "1" domain.factory.IUserConfigFactory
        service "1" o-- "1" domain.repository.IExcludedRepository
        service "1" o-- "1" domain.repository.IExtendedRepository
        service "1" o-- "1" domain.repository.IGroupRepository
    }

    namespace schedule {
        interface IService {

        }

        class service implements IService {
            -userscheduleFactory IUserScheduleFactory
            -excluded IExcludedRepository
            -extended IExtendedRepository
            -userConfig IUserConfigRepository
        }

        service "1" o-- "1" domain.factory.IUserScheduleFactory
        service "1" o-- "1" domain.repository.IExcludedRepository
        service "1" o-- "1" domain.repository.IExtendedRepository
        service "1" o-- "1" domain.repository.IGroupRepository
    }
}

@enduml